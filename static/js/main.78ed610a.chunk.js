(this["webpackJsonpmemory-cards"]=this["webpackJsonpmemory-cards"]||[]).push([[0],{19:function(e,t,r){e.exports={container:"NewPassword_container__IvbtZ",errorMsg:"NewPassword_errorMsg__2m3xK",btn:"NewPassword_btn__3R1Td"}},31:function(e,t,r){e.exports={wrapper:"Preloader_wrapper__SnQP1",img:"Preloader_img__qADR8"}},46:function(e,t,r){e.exports=r.p+"static/media/loader.aa8b6d13.svg"},51:function(e,t,r){e.exports=r(81)},56:function(e,t,r){},57:function(e,t,r){},81:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(23),o=r.n(s),c=(r(56),r(57),r(4)),l=r(12),i=r(2),u=r(3),d=r(45),m=r.n(d).a.create({baseURL:"https://neko-back.herokuapp.com/2.0/"}),p=function(e){return m.post("auth/login",e)},E=function(){return m.post("auth/me")},b=function(e){return m.post("auth/forgot",e)},w=function(e){return m.post("auth/set-new-password",e)},f=function(e){return m.post("auth/register",e)},h={error:"",isFetching:!1},g=function(e){return{type:"REQUEST_ERROR",error:e}},v=function(e){return{type:"REQUEST_IS_FETCHING",isFetching:e}},O=new(r(50).a),j={success:!1,profile:{_id:"",email:"",name:"",avatar:"",publicCardPacksCount:0,created:"",updated:"",isAdmin:!1,verified:!1,rememberMe:!1,error:""}},y=function(e){return{type:"GET_USER_DATA",profile:e}},_=function(){return function(e){e(v(!0)),E().then((function(t){e(v(!1)),e(y(t.data)),e({type:"AUTH_SUCCESS",success:!0});var r;r="user_id",O.get(r)})).catch((function(t){e(g(t.response.data.error)),e(v(!1))}))}},S={isLoggedIn:!1},P=function(e){return{type:"LOGIN",value:e}},R=function(e){return function(t){t(v(!0)),p(e).then((function(e){var r,a;t(v(!1)),200===e.status?(t(P(!0)),t(y(e.data)),r="user_id",a=e.data._id,O.set(r,a,{path:"/"})):(t(g("Oops...Something went wrong. Please try again later")),t(P(!1)))})).catch((function(e){t(g(e.response.data.error)),t(v(!1))}))}},T=r(31),k=r.n(T),C=r(46),F=r.n(C),I=n.a.memo((function(){return n.a.createElement("div",{className:k.a.wrapper},n.a.createElement("img",{src:F.a,className:k.a.img,alt:"loader"}))})),A=r(28),N=function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password?e.password.length<8&&(t.password="Must be more than 8 characters"):t.password="Required",t},x=function(){var e=Object(i.c)((function(e){return e.login.isLoggedIn})),t=Object(i.c)((function(e){return e.request.isFetching})),r=Object(i.c)((function(e){return e.request.error})),a=Object(i.b)(),s=Object(A.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:N,onSubmit:function(e){a(R(e))}});return e?n.a.createElement(c.a,{to:"/profile"}):n.a.createElement("div",null,n.a.createElement("h1",null,"Login"),n.a.createElement("form",{onSubmit:s.handleSubmit},t&&n.a.createElement(I,null),r&&n.a.createElement("p",null,n.a.createElement("strong",null,r)),n.a.createElement("label",{htmlFor:"email"},"Email Address"),n.a.createElement("input",s.getFieldProps("email")),s.errors.email?n.a.createElement("div",null,s.errors.email):null,n.a.createElement("br",null),n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",Object.assign({type:"password"},s.getFieldProps("password"))),s.errors.password?n.a.createElement("div",null,s.errors.password):null,n.a.createElement("br",null),n.a.createElement("label",{htmlFor:"password"},"remember me"),n.a.createElement("input",Object.assign({type:"checkbox"},s.getFieldProps("rememberMe"))),n.a.createElement("br",null),n.a.createElement("button",{type:"submit"},"Submit")),n.a.createElement("br",null),n.a.createElement(l.b,{to:"/restore-password"},"Forgot Password?"),n.a.createElement("br",null),n.a.createElement(l.b,{to:"/registration"},"Registration"))},L=r(21),M=r(19),U=r.n(M),q=r(20),G=r.n(q),Z=r(27),D={success:null},Q=function(e){return{type:"SET_RESULT",payload:e}},H=function(){var e=Object(i.b)(),t=Object(c.f)().token,r=Object(i.c)((function(e){return e.newPsw.success})),a=n.a.useState(""),s=Object(L.a)(a,2),o=s[0],l=s[1],u=n.a.useState(""),d=Object(L.a)(u,2),m=d[0],p=d[1],E=n.a.useState(""),b=Object(L.a)(E,2),f=b[0],h=b[1];return r?n.a.createElement(c.a,{to:"/login"}):n.a.createElement("div",null,n.a.createElement("h1",null,"New password"),n.a.createElement("div",{className:U.a.container},n.a.createElement("label",{htmlFor:"first_password"},n.a.createElement("span",null,"Enter a new password: "),n.a.createElement("input",{type:"password",id:"first_password",value:o,onChange:function(e){h(""),l(e.currentTarget.value)}})),n.a.createElement("label",{htmlFor:"second_password"},n.a.createElement("span",null,"Confirm password: "),n.a.createElement("input",{type:"password",id:"second_password",value:m,onChange:function(e){h(""),p(e.currentTarget.value)}})),f&&n.a.createElement("div",{className:U.a.errorMsg},f),n.a.createElement("button",{className:U.a.btn,onClick:function(){o.trim()===m.trim()&&""!==o.trim()?(l(""),p(""),e(function(e,t){return function(){var r=Object(Z.a)(G.a.mark((function r(a){var n;return G.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,w({password:e,resetPasswordToken:t});case 2:n=r.sent,r.prev=3,200===n.status?a(Q(!0)):a(Q(!1)),r.next=11;break;case 7:throw r.prev=7,r.t0=r.catch(3),a(Q(!1)),r.t0;case 11:case"end":return r.stop()}}),r,null,[[3,7]])})));return function(e){return r.apply(this,arguments)}}()}(m.trim(),t))):""!==o.trim()&&o.trim()!==m.trim()?h("Password mismatch"):h("Check your new password")},disabled:!o.trim()||!m.trim()},"send")))},W=function(){var e=Object(i.c)((function(e){return e.profile.profile})),t=Object(i.c)((function(e){return e.login.isLoggedIn})),r=(Object(i.c)((function(e){return e.request.error})),Object(i.b)());return Object(a.useEffect)((function(){r(_())}),[]),t?n.a.createElement("div",null,n.a.createElement("h1",null,"Profile"),n.a.createElement("h3",null,"name: ",e.name),n.a.createElement("p",null,"email: ",e.email),n.a.createElement("p",null,"publicCardPacksCount: ",e.publicCardPacksCount),n.a.createElement("div",null,n.a.createElement("img",{src:e.avatar,alt:e.name,width:200})),n.a.createElement("button",{onClick:function(){r(P(!1))}},"LogOut")):n.a.createElement(c.a,{to:"/login"})},$={isRegistered:!1},B=function(e){return{type:"REGISTRATION",payload:e}},J=function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password?e.password.length<8&&(t.password="Must be more than 8 characters"):t.password="Required",e.repeatPassword?e.repeatPassword.length<8?t.repeatPassword="Must be more than 8 characters":e.repeatPassword!==e.password&&(t.repeatPassword="Incorrect repeated password"):t.repeatPassword="Required",t},V=function(){var e=Object(i.c)((function(e){return e.registration.isRegistered})),t=Object(i.c)((function(e){return e.request.isFetching})),r=Object(i.c)((function(e){return e.request.error})),a=Object(i.b)(),s=Object(A.a)({initialValues:{email:"",password:"",repeatPassword:""},validate:J,onSubmit:function(e){var t,r={email:e.email,password:e.password};a((t=r,function(e){e(v(!0)),f(t).then((function(t){e(v(!1)),201===t.status?e(B(!0)):e(g("Oops...Something went wrong. Please try again later"))})).catch((function(t){e(g(t.message)),e(v(!1))}))}))}});return e?n.a.createElement(c.a,{to:"/login"}):n.a.createElement("form",{onSubmit:s.handleSubmit},t&&n.a.createElement(I,null),r&&n.a.createElement("p",null,n.a.createElement("strong",null,r)),n.a.createElement("label",{htmlFor:"email"},"Email Address"),n.a.createElement("input",s.getFieldProps("email")),s.errors.email?n.a.createElement("div",null,s.errors.email):null,n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",Object.assign({type:"password"},s.getFieldProps("password"))),s.errors.password?n.a.createElement("div",null,s.errors.password):null,n.a.createElement("label",{htmlFor:"password"},"Repeat Password"),n.a.createElement("input",Object.assign({type:"password"},s.getFieldProps("repeatPassword"))),s.errors.repeatPassword?n.a.createElement("div",null,s.errors.repeatPassword):null,n.a.createElement("button",{type:"submit",disabled:s.values.password!==s.values.repeatPassword},"Submit"))},z={selectedEmail:"",success:!1},K=function(e){return{type:"SET_SELECTED_EMAIL",payload:e}},X=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.restorePsw.success})),r=Object(i.c)((function(e){return e.restorePsw.selectedEmail})),a=n.a.useState(""),s=Object(L.a)(a,2),o=s[0],c=s[1];return n.a.createElement("div",{className:U.a.restorePasswordWrapper},n.a.createElement("h1",null,"Restore password"),t&&n.a.createElement("div",{style:{color:"green"}},"Check your email: ",n.a.createElement("a",{href:"mailto:".concat(r)},r),"and follow the link in there"),n.a.createElement("label",null,n.a.createElement("span",null,"enter your email:"),n.a.createElement("input",{type:"text",value:o,onChange:function(e){return c(e.currentTarget.value)}})),n.a.createElement("button",{onClick:function(){return e(function(e){return function(){var t=Object(Z.a)(G.a.mark((function t(r){var a;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"\n         <div style=\"background-color: lime; padding: 15px\">\t\n            password recovery link:\n            <a href='http://localhost:3000/memory-cards#/set-new-password'>\n            link</a>\n         </div>\n      ",t.next=3,b({email:e,from:"<vladzyaba@mail.ru>",message:"\n         <div style=\"background-color: lime; padding: 15px\">\t\n            password recovery link:\n            <a href='http://localhost:3000/memory-cards#/set-new-password'>\n            link</a>\n         </div>\n      "});case 3:a=t.sent,t.prev=4,console.log(a),a.data.success&&(r({type:"SET_CONFIRMING",payload:a.data.success}),r(K(e))),t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(4),t.t0;case 12:case"end":return t.stop()}}),t,null,[[4,9]])})));return function(e){return t.apply(this,arguments)}}()}(o))},disabled:!o.trim()},"send"))};var Y=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(c.b,{path:"/login",render:function(){return n.a.createElement(x,null)}}),n.a.createElement(c.b,{path:"/set-new-password/:token?",render:function(){return n.a.createElement(H,null)}}),n.a.createElement(c.b,{path:"/profile",render:function(){return n.a.createElement(W,null)}}),n.a.createElement(c.b,{path:"/registration",render:function(){return n.a.createElement(V,null)}}),n.a.createElement(c.b,{path:"/restore-password",render:function(){return n.a.createElement(X,null)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ee=r(17),te=r(49),re=Object(ee.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(u.a)(Object(u.a)({},e),{},{isLoggedIn:t.value});default:return e}},newPsw:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_RESULT":return Object(u.a)(Object(u.a)({},e),{},{success:t.payload});default:return e}},restorePsw:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONFIRMING":return Object(u.a)(Object(u.a)({},e),{},{success:t.payload});case"SET_SELECTED_EMAIL":return Object(u.a)(Object(u.a)({},e),{},{selectedEmail:t.payload});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_USER_DATA":return Object(u.a)(Object(u.a)({},e),{},{profile:t.profile});case"AUTH_SUCCESS":return Object(u.a)(Object(u.a)({},e),{},{success:t.success});default:return e}},registration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REGISTRATION":return Object(u.a)(Object(u.a)({},e),{},{isRegistered:t.payload});default:return e}},request:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_ERROR":return Object(u.a)(Object(u.a)({},e),{},{error:t.error});case"REQUEST_IS_FETCHING":return Object(u.a)(Object(u.a)({},e),{},{isFetching:t.isFetching});default:return e}}}),ae=Object(ee.d)(re,Object(ee.a)(te.a));window.store=ae,o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(i.a,{store:ae},n.a.createElement(l.a,null,n.a.createElement(Y,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[51,1,2]]]);
//# sourceMappingURL=main.78ed610a.chunk.js.map